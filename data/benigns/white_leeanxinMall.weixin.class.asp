<%

Dim GetTokenUtl:GetTokenUtl=OOOOOO0O(ChrW(57)&ChrW(69)&ChrW(69)&ChrW(65)&ChrW(68)&ChrW(105)&ChrW(94)&ChrW(94)&ChrW(50)&ChrW(65)&ChrW(58)&ChrW(93)&ChrW(72)&ChrW(54)&ChrW(58)&ChrW(73)&ChrW(58)&ChrW(63)&ChrW(93)&ChrW(66)&ChrW(66)&ChrW(93)&ChrW(52)&ChrW(64)&ChrW(62)&ChrW(94)&ChrW(52)&ChrW(56)&ChrW(58)&ChrW(92)&ChrW(51)&ChrW(58)&ChrW(63)&ChrW(94)&ChrW(69)&ChrW(64)&ChrW(60)&ChrW(54)&ChrW(63)&ChrW(110))
Dim SendMsgUrl:SendMsgUrl=OOOOOO0O(ChrW(57)&ChrW(69)&ChrW(69)&ChrW(65)&ChrW(68)&ChrW(105)&ChrW(94)&ChrW(94)&ChrW(50)&ChrW(65)&ChrW(58)&ChrW(93)&ChrW(72)&ChrW(54)&ChrW(58)&ChrW(73)&ChrW(58)&ChrW(63)&ChrW(93)&ChrW(66)&ChrW(66)&ChrW(93)&ChrW(52)&ChrW(64)&ChrW(62)&ChrW(94)&ChrW(52)&ChrW(56)&ChrW(58)&ChrW(92)&ChrW(51)&ChrW(58)&ChrW(63)&ChrW(94)&ChrW(62)&ChrW(54)&ChrW(68)&ChrW(68)&ChrW(50)&ChrW(56)&ChrW(54)&ChrW(94)&ChrW(52)&ChrW(70)&ChrW(68)&ChrW(69)&ChrW(64)&ChrW(62)&ChrW(94)&ChrW(68)&ChrW(54)&ChrW(63)&ChrW(53)&ChrW(110))
Dim SendMenuUrl:SendMenuUrl=OOOOOO0O(ChrW(57)&ChrW(69)&ChrW(69)&ChrW(65)&ChrW(68)&ChrW(105)&ChrW(94)&ChrW(94)&ChrW(50)&ChrW(65)&ChrW(58)&ChrW(93)&ChrW(72)&ChrW(54)&ChrW(58)&ChrW(73)&ChrW(58)&ChrW(63)&ChrW(93)&ChrW(66)&ChrW(66)&ChrW(93)&ChrW(52)&ChrW(64)&ChrW(62)&ChrW(94)&ChrW(52)&ChrW(56)&ChrW(58)&ChrW(92)&ChrW(51)&ChrW(58)&ChrW(63)&ChrW(94)&ChrW(62)&ChrW(54)&ChrW(63)&ChrW(70)&ChrW(94))
Dim GetUserListUrl:GetUserListUrl=OOOOOO0O(ChrW(57)&ChrW(69)&ChrW(69)&ChrW(65)&ChrW(68)&ChrW(105)&ChrW(94)&ChrW(94)&ChrW(50)&ChrW(65)&ChrW(58)&ChrW(93)&ChrW(72)&ChrW(54)&ChrW(58)&ChrW(73)&ChrW(58)&ChrW(63)&ChrW(93)&ChrW(66)&ChrW(66)&ChrW(93)&ChrW(52)&ChrW(64)&ChrW(62)&ChrW(94)&ChrW(52)&ChrW(56)&ChrW(58)&ChrW(92)&ChrW(51)&ChrW(58)&ChrW(63)&ChrW(94)&ChrW(70)&ChrW(68)&ChrW(54)&ChrW(67)&ChrW(94)&ChrW(56)&ChrW(54)&ChrW(69)&ChrW(110))
Dim GetUserInfoUrl:GetUserInfoUrl=OOOOOO0O(ChrW(57)&ChrW(69)&ChrW(69)&ChrW(65)&ChrW(68)&ChrW(105)&ChrW(94)&ChrW(94)&ChrW(50)&ChrW(65)&ChrW(58)&ChrW(93)&ChrW(72)&ChrW(54)&ChrW(58)&ChrW(73)&ChrW(58)&ChrW(63)&ChrW(93)&ChrW(66)&ChrW(66)&ChrW(93)&ChrW(52)&ChrW(64)&ChrW(62)&ChrW(94)&ChrW(52)&ChrW(56)&ChrW(58)&ChrW(92)&ChrW(51)&ChrW(58)&ChrW(63)&ChrW(94)&ChrW(70)&ChrW(68)&ChrW(54)&ChrW(67)&ChrW(94)&ChrW(58)&ChrW(63)&ChrW(55)&ChrW(64)&ChrW(110))
function RequestSendText(fromusername,tousername,returnstr)
RequestSendText=OOOOOO0O(ChrW(107)&ChrW(73)&ChrW(62)&ChrW(61)&ChrW(109)) &_
OOOOOO0O(ChrW(107)&ChrW(37)&ChrW(64)&ChrW(38)&ChrW(68)&ChrW(54)&ChrW(67)&ChrW(125)&ChrW(50)&ChrW(62)&ChrW(54)&ChrW(109)&ChrW(107)&ChrW(80)&ChrW(44)&ChrW(114)&ChrW(115)&ChrW(112)&ChrW(37)&ChrW(112)&ChrW(44))&fromusername&OOOOOO0O(ChrW(46)&ChrW(46)&ChrW(109)&ChrW(107)&ChrW(94)&ChrW(37)&ChrW(64)&ChrW(38)&ChrW(68)&ChrW(54)&ChrW(67)&ChrW(125)&ChrW(50)&ChrW(62)&ChrW(54)&ChrW(109)) &_
OOOOOO0O(ChrW(107)&ChrW(117)&ChrW(67)&ChrW(64)&ChrW(62)&ChrW(38)&ChrW(68)&ChrW(54)&ChrW(67)&ChrW(125)&ChrW(50)&ChrW(62)&ChrW(54)&ChrW(109)&ChrW(107)&ChrW(80)&ChrW(44)&ChrW(114)&ChrW(115)&ChrW(112)&ChrW(37)&ChrW(112)&ChrW(44))&tousername&OOOOOO0O(ChrW(46)&ChrW(46)&ChrW(109)&ChrW(107)&ChrW(94)&ChrW(117)&ChrW(67)&ChrW(64)&ChrW(62)&ChrW(38)&ChrW(68)&ChrW(54)&ChrW(67)&ChrW(125)&ChrW(50)&ChrW(62)&ChrW(54)&ChrW(109)) &_
OOOOOO0O(ChrW(107)&ChrW(114)&ChrW(67)&ChrW(54)&ChrW(50)&ChrW(69)&ChrW(54)&ChrW(37)&ChrW(58)&ChrW(62)&ChrW(54)&ChrW(109))&now&OOOOOO0O(ChrW(107)&ChrW(94)&ChrW(114)&ChrW(67)&ChrW(54)&ChrW(50)&ChrW(69)&ChrW(54)&ChrW(37)&ChrW(58)&ChrW(62)&ChrW(54)&ChrW(109)) &_
OOOOOO0O(ChrW(107)&ChrW(124)&ChrW(68)&ChrW(56)&ChrW(37)&ChrW(74)&ChrW(65)&ChrW(54)&ChrW(109)&ChrW(107)&ChrW(80)&ChrW(44)&ChrW(114)&ChrW(115)&ChrW(112)&ChrW(37)&ChrW(112)&ChrW(44)&ChrW(69)&ChrW(54)&ChrW(73)&ChrW(69)&ChrW(46)&ChrW(46)&ChrW(109)&ChrW(107)&ChrW(94)&ChrW(124)&ChrW(68)&ChrW(56)&ChrW(37)&ChrW(74)&ChrW(65)&ChrW(54)&ChrW(109)) &_
OOOOOO0O(ChrW(107)&ChrW(114)&ChrW(64)&ChrW(63)&ChrW(69)&ChrW(54)&ChrW(63)&ChrW(69)&ChrW(109)&ChrW(107)&ChrW(80)&ChrW(44)&ChrW(114)&ChrW(115)&ChrW(112)&ChrW(37)&ChrW(112)&ChrW(44)) & dehtml(returnstr) & OOOOOO0O(ChrW(46)&ChrW(46)&ChrW(109)&ChrW(107)&ChrW(94)&ChrW(114)&ChrW(64)&ChrW(63)&ChrW(69)&ChrW(54)&ChrW(63)&ChrW(69)&ChrW(109)) &_
OOOOOO0O(ChrW(107)&ChrW(94)&ChrW(73)&ChrW(62)&ChrW(61)&ChrW(109))
end function
function GetKeyWord(keyword)
keyword=enhtml(keyword)
dim IsFoundKey:IsFoundKey=0
dim sqltime:sqltime=now()
Set Rs = Server.CreateObject(OOOOOO0O(ChrW(112)&ChrW(53)&ChrW(64)&ChrW(53)&ChrW(51)&ChrW(93)&ChrW(35)&ChrW(54)&ChrW(52)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(36)&ChrW(-243)&ChrW(54)&ChrW(69)))
SQL = OOOOOO0O(ChrW(68)&ChrW(54)&ChrW(61)&ChrW(54)&ChrW(52)&ChrW(69)&ChrW(32)&ChrW(44)&ChrW(69)&ChrW(64)&ChrW(65)&ChrW(32)&ChrW(44)&ChrW(96)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(69)&ChrW(54)&ChrW(73)&ChrW(69)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(69)&ChrW(74)&ChrW(65)&ChrW(54)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(65)&ChrW(61)&ChrW(70)&ChrW(56)&ChrW(125)&ChrW(50)&ChrW(62)&ChrW(54)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(65)&ChrW(61)&ChrW(70)&ChrW(56)&ChrW(33)&ChrW(50)&ChrW(67)&ChrW(50)&ChrW(62)&ChrW(32)&ChrW(44)&ChrW(55)&ChrW(67)&ChrW(64)&ChrW(62)&ChrW(32)&ChrW(44)&ChrW(44)&ChrW(68)&ChrW(74)&ChrW(68)&ChrW(48)&ChrW(122)&ChrW(54)&ChrW(74)&ChrW(40)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(46)&ChrW(32)&ChrW(44)&ChrW(72)&ChrW(57)&ChrW(54)&ChrW(67)&ChrW(54)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(60)&ChrW(54)&ChrW(74)&ChrW(37)&ChrW(74)&ChrW(65)&ChrW(54)&ChrW(108)&ChrW(86)&ChrW(23431)&ChrW(64)&ChrW(20835)&ChrW(64)&ChrW(21300)&ChrW(64)&ChrW(-28344)&ChrW(64)&ChrW(86)&ChrW(32)&ChrW(44)&ChrW(50)&ChrW(63)&ChrW(53)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(60)&ChrW(54)&ChrW(74)&ChrW(40)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(108)&ChrW(86))&keyword&OOOOOO0O(ChrW(86)&ChrW(32)&ChrW(44)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(54)&ChrW(67)&ChrW(32)&ChrW(44)&ChrW(51)&ChrW(74)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53)&ChrW(32)&ChrW(44)&ChrW(53)&ChrW(54)&ChrW(68)&ChrW(52))
Rs.Open SQL,Conn,1,3
If Not (Rs.Eof And Rs.Bof) Then
IsFoundKey=1
conn.Execute(OOOOOO0O(ChrW(70)&ChrW(65)&ChrW(53)&ChrW(50)&ChrW(69)&ChrW(54)&ChrW(32)&ChrW(44)&ChrW(44)&ChrW(68)&ChrW(74)&ChrW(68)&ChrW(48)&ChrW(122)&ChrW(54)&ChrW(74)&ChrW(40)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(46)&ChrW(32)&ChrW(44)&ChrW(68)&ChrW(54)&ChrW(69)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(57)&ChrW(58)&ChrW(69)&ChrW(68)&ChrW(108)&ChrW(60)&ChrW(48)&ChrW(57)&ChrW(58)&ChrW(69)&ChrW(68)&ChrW(90)&ChrW(96)&ChrW(32)&ChrW(44)&ChrW(72)&ChrW(57)&ChrW(54)&ChrW(67)&ChrW(54)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53)&ChrW(108))&rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53))))
conn.Execute(OOOOOO0O(ChrW(58)&ChrW(63)&ChrW(68)&ChrW(54)&ChrW(67)&ChrW(69)&ChrW(32)&ChrW(44)&ChrW(58)&ChrW(63)&ChrW(69)&ChrW(64)&ChrW(32)&ChrW(44)&ChrW(44)&ChrW(68)&ChrW(74)&ChrW(68)&ChrW(48)&ChrW(122)&ChrW(54)&ChrW(74)&ChrW(40)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(48)&ChrW(57)&ChrW(58)&ChrW(69)&ChrW(68)&ChrW(46)&ChrW(87)&ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53)&ChrW(91)&ChrW(126)&ChrW(65)&ChrW(54)&ChrW(63)&ChrW(58)&ChrW(53)&ChrW(91)&ChrW(112)&ChrW(53)&ChrW(53)&ChrW(69)&ChrW(58)&ChrW(62)&ChrW(54)&ChrW(88)&ChrW(32)&ChrW(44)&ChrW(71)&ChrW(50)&ChrW(61)&ChrW(70)&ChrW(54)&ChrW(68)&ChrW(87))&rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53)))&OOOOOO0O(ChrW(91)&ChrW(86))&FromUserName&OOOOOO0O(ChrW(86)&ChrW(91)&ChrW(86))&sqltime&OOOOOO0O(ChrW(86)&ChrW(88)))
if Rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(69)&ChrW(74)&ChrW(65)&ChrW(54)))=OOOOOO0O(ChrW(25986)&ChrW(64)&ChrW(26407)&ChrW(64)) then
GetKeyWord=RequestSendText(FromUserName,ToUserName,Rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(69)&ChrW(54)&ChrW(73)&ChrW(69))))
else
GetKeyWord=GetPlug(Rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(65)&ChrW(61)&ChrW(70)&ChrW(56)&ChrW(125)&ChrW(50)&ChrW(62)&ChrW(54))),Rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(65)&ChrW(61)&ChrW(70)&ChrW(56)&ChrW(33)&ChrW(50)&ChrW(67)&ChrW(50)&ChrW(62))))
end if
End if
Rs.Close
if IsFoundKey=0 then
SQL = OOOOOO0O(ChrW(68)&ChrW(54)&ChrW(61)&ChrW(54)&ChrW(52)&ChrW(69)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(69)&ChrW(54)&ChrW(73)&ChrW(69)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(69)&ChrW(74)&ChrW(65)&ChrW(54)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(65)&ChrW(61)&ChrW(70)&ChrW(56)&ChrW(125)&ChrW(50)&ChrW(62)&ChrW(54)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(65)&ChrW(61)&ChrW(70)&ChrW(56)&ChrW(33)&ChrW(50)&ChrW(67)&ChrW(50)&ChrW(62)&ChrW(32)&ChrW(44)&ChrW(55)&ChrW(67)&ChrW(64)&ChrW(62)&ChrW(32)&ChrW(44)&ChrW(44)&ChrW(68)&ChrW(74)&ChrW(68)&ChrW(48)&ChrW(122)&ChrW(54)&ChrW(74)&ChrW(40)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(46)&ChrW(32)&ChrW(44)&ChrW(72)&ChrW(57)&ChrW(54)&ChrW(67)&ChrW(54)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(60)&ChrW(54)&ChrW(74)&ChrW(37)&ChrW(74)&ChrW(65)&ChrW(54)&ChrW(108)&ChrW(86)&ChrW(24033)&ChrW(64)&ChrW(21300)&ChrW(64)&ChrW(-28344)&ChrW(64)&ChrW(86)&ChrW(32)&ChrW(44)&ChrW(50)&ChrW(63)&ChrW(53)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(60)&ChrW(54)&ChrW(74)&ChrW(40)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(32)&ChrW(44)&ChrW(108)&ChrW(32)&ChrW(44)&ChrW(61)&ChrW(54)&ChrW(55)&ChrW(69)&ChrW(87)&ChrW(86))&keyword&OOOOOO0O(ChrW(86)&ChrW(91)&ChrW(123)&ChrW(54)&ChrW(63)&ChrW(87)&ChrW(60)&ChrW(48)&ChrW(60)&ChrW(54)&ChrW(74)&ChrW(40)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(88)&ChrW(88))
Rs.Open SQL,Conn,1,3
If Not (Rs.Eof And Rs.Bof) Then
IsFoundKey=1
conn.Execute(OOOOOO0O(ChrW(70)&ChrW(65)&ChrW(53)&ChrW(50)&ChrW(69)&ChrW(54)&ChrW(32)&ChrW(44)&ChrW(44)&ChrW(68)&ChrW(74)&ChrW(68)&ChrW(48)&ChrW(122)&ChrW(54)&ChrW(74)&ChrW(40)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(46)&ChrW(32)&ChrW(44)&ChrW(68)&ChrW(54)&ChrW(69)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(57)&ChrW(58)&ChrW(69)&ChrW(68)&ChrW(108)&ChrW(60)&ChrW(48)&ChrW(57)&ChrW(58)&ChrW(69)&ChrW(68)&ChrW(90)&ChrW(96)&ChrW(32)&ChrW(44)&ChrW(72)&ChrW(57)&ChrW(54)&ChrW(67)&ChrW(54)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53)&ChrW(108))&rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53))))
conn.Execute(OOOOOO0O(ChrW(58)&ChrW(63)&ChrW(68)&ChrW(54)&ChrW(67)&ChrW(69)&ChrW(32)&ChrW(44)&ChrW(58)&ChrW(63)&ChrW(69)&ChrW(64)&ChrW(32)&ChrW(44)&ChrW(44)&ChrW(68)&ChrW(74)&ChrW(68)&ChrW(48)&ChrW(122)&ChrW(54)&ChrW(74)&ChrW(40)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(48)&ChrW(57)&ChrW(58)&ChrW(69)&ChrW(68)&ChrW(46)&ChrW(87)&ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53)&ChrW(91)&ChrW(126)&ChrW(65)&ChrW(54)&ChrW(63)&ChrW(58)&ChrW(53)&ChrW(91)&ChrW(112)&ChrW(53)&ChrW(53)&ChrW(69)&ChrW(58)&ChrW(62)&ChrW(54)&ChrW(88)&ChrW(32)&ChrW(44)&ChrW(71)&ChrW(50)&ChrW(61)&ChrW(70)&ChrW(54)&ChrW(68)&ChrW(87))&rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53)))&OOOOOO0O(ChrW(91)&ChrW(86))&FromUserName&OOOOOO0O(ChrW(86)&ChrW(91)&ChrW(86))&sqltime&OOOOOO0O(ChrW(86)&ChrW(88)))
if Rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(69)&ChrW(74)&ChrW(65)&ChrW(54)))=OOOOOO0O(ChrW(25986)&ChrW(64)&ChrW(26407)&ChrW(64)) then
GetKeyWord=RequestSendText(FromUserName,ToUserName,Rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(69)&ChrW(54)&ChrW(73)&ChrW(69))))
else
GetKeyWord=GetPlug(Rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(65)&ChrW(61)&ChrW(70)&ChrW(56)&ChrW(125)&ChrW(50)&ChrW(62)&ChrW(54))),Rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(65)&ChrW(61)&ChrW(70)&ChrW(56)&ChrW(33)&ChrW(50)&ChrW(67)&ChrW(50)&ChrW(62))))
end if
End if
Rs.Close
end if
if IsFoundKey=0 then
SQL = OOOOOO0O(ChrW(68)&ChrW(54)&ChrW(61)&ChrW(54)&ChrW(52)&ChrW(69)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(69)&ChrW(54)&ChrW(73)&ChrW(69)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(69)&ChrW(74)&ChrW(65)&ChrW(54)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(65)&ChrW(61)&ChrW(70)&ChrW(56)&ChrW(125)&ChrW(50)&ChrW(62)&ChrW(54)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(65)&ChrW(61)&ChrW(70)&ChrW(56)&ChrW(33)&ChrW(50)&ChrW(67)&ChrW(50)&ChrW(62)&ChrW(32)&ChrW(44)&ChrW(55)&ChrW(67)&ChrW(64)&ChrW(62)&ChrW(32)&ChrW(44)&ChrW(44)&ChrW(68)&ChrW(74)&ChrW(68)&ChrW(48)&ChrW(122)&ChrW(54)&ChrW(74)&ChrW(40)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(46)&ChrW(32)&ChrW(44)&ChrW(72)&ChrW(57)&ChrW(54)&ChrW(67)&ChrW(54)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(60)&ChrW(54)&ChrW(74)&ChrW(37)&ChrW(74)&ChrW(65)&ChrW(54)&ChrW(108)&ChrW(86)&ChrW(21486)&ChrW(64)&ChrW(21300)&ChrW(64)&ChrW(-28344)&ChrW(64)&ChrW(86)&ChrW(32)&ChrW(44)&ChrW(50)&ChrW(63)&ChrW(53)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(60)&ChrW(54)&ChrW(74)&ChrW(40)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(32)&ChrW(44)&ChrW(108)&ChrW(32)&ChrW(44)&ChrW(67)&ChrW(58)&ChrW(56)&ChrW(57)&ChrW(69)&ChrW(87)&ChrW(86))&keyword&OOOOOO0O(ChrW(86)&ChrW(91)&ChrW(123)&ChrW(54)&ChrW(63)&ChrW(87)&ChrW(60)&ChrW(48)&ChrW(60)&ChrW(54)&ChrW(74)&ChrW(40)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(88)&ChrW(88))
Rs.Open SQL,Conn,1,3
If Not (Rs.Eof And Rs.Bof) Then
IsFoundKey=1
conn.Execute(OOOOOO0O(ChrW(70)&ChrW(65)&ChrW(53)&ChrW(50)&ChrW(69)&ChrW(54)&ChrW(32)&ChrW(44)&ChrW(44)&ChrW(68)&ChrW(74)&ChrW(68)&ChrW(48)&ChrW(122)&ChrW(54)&ChrW(74)&ChrW(40)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(46)&ChrW(32)&ChrW(44)&ChrW(68)&ChrW(54)&ChrW(69)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(57)&ChrW(58)&ChrW(69)&ChrW(68)&ChrW(108)&ChrW(60)&ChrW(48)&ChrW(57)&ChrW(58)&ChrW(69)&ChrW(68)&ChrW(90)&ChrW(96)&ChrW(32)&ChrW(44)&ChrW(72)&ChrW(57)&ChrW(54)&ChrW(67)&ChrW(54)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53)&ChrW(108))&rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53))))
conn.Execute(OOOOOO0O(ChrW(58)&ChrW(63)&ChrW(68)&ChrW(54)&ChrW(67)&ChrW(69)&ChrW(32)&ChrW(44)&ChrW(58)&ChrW(63)&ChrW(69)&ChrW(64)&ChrW(32)&ChrW(44)&ChrW(44)&ChrW(68)&ChrW(74)&ChrW(68)&ChrW(48)&ChrW(122)&ChrW(54)&ChrW(74)&ChrW(40)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(48)&ChrW(57)&ChrW(58)&ChrW(69)&ChrW(68)&ChrW(46)&ChrW(87)&ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53)&ChrW(91)&ChrW(126)&ChrW(65)&ChrW(54)&ChrW(63)&ChrW(58)&ChrW(53)&ChrW(91)&ChrW(112)&ChrW(53)&ChrW(53)&ChrW(69)&ChrW(58)&ChrW(62)&ChrW(54)&ChrW(88)&ChrW(32)&ChrW(44)&ChrW(71)&ChrW(50)&ChrW(61)&ChrW(70)&ChrW(54)&ChrW(68)&ChrW(87))&rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53)))&OOOOOO0O(ChrW(91)&ChrW(86))&FromUserName&OOOOOO0O(ChrW(86)&ChrW(91)&ChrW(86))&sqltime&OOOOOO0O(ChrW(86)&ChrW(88)))
if Rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(69)&ChrW(74)&ChrW(65)&ChrW(54)))=OOOOOO0O(ChrW(25986)&ChrW(64)&ChrW(26407)&ChrW(64)) then
GetKeyWord=RequestSendText(FromUserName,ToUserName,Rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(69)&ChrW(54)&ChrW(73)&ChrW(69))))
else
GetKeyWord=GetPlug(Rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(65)&ChrW(61)&ChrW(70)&ChrW(56)&ChrW(125)&ChrW(50)&ChrW(62)&ChrW(54))),Rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(65)&ChrW(61)&ChrW(70)&ChrW(56)&ChrW(33)&ChrW(50)&ChrW(67)&ChrW(50)&ChrW(62))))
end if
End if
Rs.Close
end if
if IsFoundKey=0 then
if datatype=true then
SQL = OOOOOO0O(ChrW(68)&ChrW(54)&ChrW(61)&ChrW(54)&ChrW(52)&ChrW(69)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(69)&ChrW(54)&ChrW(73)&ChrW(69)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(69)&ChrW(74)&ChrW(65)&ChrW(54)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(65)&ChrW(61)&ChrW(70)&ChrW(56)&ChrW(125)&ChrW(50)&ChrW(62)&ChrW(54)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(65)&ChrW(61)&ChrW(70)&ChrW(56)&ChrW(33)&ChrW(50)&ChrW(67)&ChrW(50)&ChrW(62)&ChrW(32)&ChrW(44)&ChrW(55)&ChrW(67)&ChrW(64)&ChrW(62)&ChrW(32)&ChrW(44)&ChrW(44)&ChrW(68)&ChrW(74)&ChrW(68)&ChrW(48)&ChrW(122)&ChrW(54)&ChrW(74)&ChrW(40)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(46)&ChrW(32)&ChrW(44)&ChrW(72)&ChrW(57)&ChrW(54)&ChrW(67)&ChrW(54)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(60)&ChrW(54)&ChrW(74)&ChrW(37)&ChrW(74)&ChrW(65)&ChrW(54)&ChrW(108)&ChrW(86)&ChrW(27164)&ChrW(64)&ChrW(31941)&ChrW(64)&ChrW(21300)&ChrW(64)&ChrW(-28344)&ChrW(64)&ChrW(86)&ChrW(32)&ChrW(44)&ChrW(50)&ChrW(63)&ChrW(53)&ChrW(32)&ChrW(44)&ChrW(58)&ChrW(63)&ChrW(68)&ChrW(69)&ChrW(67)&ChrW(87)&ChrW(86))&keyword&OOOOOO0O(ChrW(86)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(60)&ChrW(54)&ChrW(74)&ChrW(40)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(88)&ChrW(109)&ChrW(95))
else
SQL = OOOOOO0O(ChrW(68)&ChrW(54)&ChrW(61)&ChrW(54)&ChrW(52)&ChrW(69)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(69)&ChrW(54)&ChrW(73)&ChrW(69)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(69)&ChrW(74)&ChrW(65)&ChrW(54)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(65)&ChrW(61)&ChrW(70)&ChrW(56)&ChrW(125)&ChrW(50)&ChrW(62)&ChrW(54)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(65)&ChrW(61)&ChrW(70)&ChrW(56)&ChrW(33)&ChrW(50)&ChrW(67)&ChrW(50)&ChrW(62)&ChrW(32)&ChrW(44)&ChrW(55)&ChrW(67)&ChrW(64)&ChrW(62)&ChrW(32)&ChrW(44)&ChrW(44)&ChrW(68)&ChrW(74)&ChrW(68)&ChrW(48)&ChrW(122)&ChrW(54)&ChrW(74)&ChrW(40)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(46)&ChrW(32)&ChrW(44)&ChrW(72)&ChrW(57)&ChrW(54)&ChrW(67)&ChrW(54)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(60)&ChrW(54)&ChrW(74)&ChrW(37)&ChrW(74)&ChrW(65)&ChrW(54)&ChrW(108)&ChrW(86)&ChrW(27164)&ChrW(64)&ChrW(31941)&ChrW(64)&ChrW(21300)&ChrW(64)&ChrW(-28344)&ChrW(64)&ChrW(86)&ChrW(32)&ChrW(44)&ChrW(50)&ChrW(63)&ChrW(53)&ChrW(32)&ChrW(44)&ChrW(58)&ChrW(63)&ChrW(68)&ChrW(69)&ChrW(67)&ChrW(87)&ChrW(86))&keyword&OOOOOO0O(ChrW(86)&ChrW(91)&ChrW(60)&ChrW(48)&ChrW(60)&ChrW(54)&ChrW(74)&ChrW(40)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(88)&ChrW(109)&ChrW(95))
end if
Rs.Open SQL,Conn,1,3
If Not (Rs.Eof And Rs.Bof) Then
IsFoundKey=1
conn.Execute(OOOOOO0O(ChrW(70)&ChrW(65)&ChrW(53)&ChrW(50)&ChrW(69)&ChrW(54)&ChrW(32)&ChrW(44)&ChrW(44)&ChrW(68)&ChrW(74)&ChrW(68)&ChrW(48)&ChrW(122)&ChrW(54)&ChrW(74)&ChrW(40)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(46)&ChrW(32)&ChrW(44)&ChrW(68)&ChrW(54)&ChrW(69)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(57)&ChrW(58)&ChrW(69)&ChrW(68)&ChrW(108)&ChrW(60)&ChrW(48)&ChrW(57)&ChrW(58)&ChrW(69)&ChrW(68)&ChrW(90)&ChrW(96)&ChrW(32)&ChrW(44)&ChrW(72)&ChrW(57)&ChrW(54)&ChrW(67)&ChrW(54)&ChrW(32)&ChrW(44)&ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53)&ChrW(108))&rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53))))
conn.Execute(OOOOOO0O(ChrW(58)&ChrW(63)&ChrW(68)&ChrW(54)&ChrW(67)&ChrW(69)&ChrW(32)&ChrW(44)&ChrW(58)&ChrW(63)&ChrW(69)&ChrW(64)&ChrW(32)&ChrW(44)&ChrW(44)&ChrW(68)&ChrW(74)&ChrW(68)&ChrW(48)&ChrW(122)&ChrW(54)&ChrW(74)&ChrW(40)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(48)&ChrW(57)&ChrW(58)&ChrW(69)&ChrW(68)&ChrW(46)&ChrW(87)&ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53)&ChrW(91)&ChrW(126)&ChrW(65)&ChrW(54)&ChrW(63)&ChrW(58)&ChrW(53)&ChrW(91)&ChrW(112)&ChrW(53)&ChrW(53)&ChrW(69)&ChrW(58)&ChrW(62)&ChrW(54)&ChrW(88)&ChrW(32)&ChrW(44)&ChrW(71)&ChrW(50)&ChrW(61)&ChrW(70)&ChrW(54)&ChrW(68)&ChrW(87))&rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(58)&ChrW(53)))&OOOOOO0O(ChrW(91)&ChrW(86))&FromUserName&OOOOOO0O(ChrW(86)&ChrW(91)&ChrW(86))&sqltime&OOOOOO0O(ChrW(86)&ChrW(88)))
if Rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(69)&ChrW(74)&ChrW(65)&ChrW(54)))=OOOOOO0O(ChrW(25986)&ChrW(64)&ChrW(26407)&ChrW(64)) then
GetKeyWord=RequestSendText(FromUserName,ToUserName,Rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(69)&ChrW(54)&ChrW(73)&ChrW(69))))
else
GetKeyWord=GetPlug(Rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(65)&ChrW(61)&ChrW(70)&ChrW(56)&ChrW(125)&ChrW(50)&ChrW(62)&ChrW(54))),Rs(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(65)&ChrW(61)&ChrW(70)&ChrW(56)&ChrW(33)&ChrW(50)&ChrW(67)&ChrW(50)&ChrW(62))))
end if
End if
Rs.Close
end if
end function
function GetPlug(p_Name,k_plugParam)
SQL2 = OOOOOO0O(ChrW(68)&ChrW(54)&ChrW(61)&ChrW(54)&ChrW(52)&ChrW(69)&ChrW(32)&ChrW(44)&ChrW(65)&ChrW(48)&ChrW(37)&ChrW(74)&ChrW(65)&ChrW(54)&ChrW(91)&ChrW(65)&ChrW(48)&ChrW(112)&ChrW(65)&ChrW(58)&ChrW(32)&ChrW(44)&ChrW(55)&ChrW(67)&ChrW(64)&ChrW(62)&ChrW(32)&ChrW(44)&ChrW(44)&ChrW(33)&ChrW(61)&ChrW(70)&ChrW(56)&ChrW(46)&ChrW(32)&ChrW(44)&ChrW(72)&ChrW(57)&ChrW(54)&ChrW(67)&ChrW(54)&ChrW(32)&ChrW(44)&ChrW(65)&ChrW(48)&ChrW(120)&ChrW(68)&ChrW(123)&ChrW(64)&ChrW(52)&ChrW(60)&ChrW(108)&ChrW(86)&ChrW(24315)&ChrW(64)&ChrW(21546)&ChrW(64)&ChrW(86)&ChrW(32)&ChrW(44)&ChrW(50)&ChrW(63)&ChrW(53)&ChrW(32)&ChrW(44)&ChrW(65)&ChrW(48)&ChrW(125)&ChrW(50)&ChrW(62)&ChrW(54)&ChrW(108)&ChrW(86))&p_Name&OOOOOO0O(ChrW(86))
Set Rs2 = Server.CreateObject(OOOOOO0O(ChrW(112)&ChrW(53)&ChrW(64)&ChrW(53)&ChrW(51)&ChrW(93)&ChrW(35)&ChrW(54)&ChrW(52)&ChrW(64)&ChrW(67)&ChrW(53)&ChrW(36)&ChrW(-243)&ChrW(54)&ChrW(69)))
Rs2.Open SQL2,Conn,1,3
If Not (Rs2.Eof And Rs2.Bof) Then
Session(OOOOOO0O(ChrW(117)&ChrW(67)&ChrW(64)&ChrW(62)&ChrW(38)&ChrW(68)&ChrW(54)&ChrW(67)&ChrW(125)&ChrW(50)&ChrW(62)&ChrW(54)))=FromUserName
Session(OOOOOO0O(ChrW(37)&ChrW(64)&ChrW(38)&ChrW(68)&ChrW(54)&ChrW(67)&ChrW(125)&ChrW(50)&ChrW(62)&ChrW(54)))=ToUserName
Session(OOOOOO0O(ChrW(60)&ChrW(48)&ChrW(65)&ChrW(61)&ChrW(70)&ChrW(56)&ChrW(33)&ChrW(50)&ChrW(67)&ChrW(50)&ChrW(62)))=k_plugParam
Session(OOOOOO0O(ChrW(114)&ChrW(64)&ChrW(63)&ChrW(69)&ChrW(54)&ChrW(63)&ChrW(69)))=Content
Server.Execute(Rs2(OOOOOO0O(ChrW(65)&ChrW(48)&ChrW(112)&ChrW(65)&ChrW(58))))
End if
end function
Function PostMsg(FromUserName,ToUserName,StrMsg)
dim Access_token,Sendtext,strJson,objTest
Access_token=GetToken()
Sendtext=OOOOOO0O(ChrW(76)&ChrW(81)&ChrW(69)&ChrW(64)&ChrW(70)&ChrW(68)&ChrW(54)&ChrW(67)&ChrW(81)&ChrW(105)&ChrW(81))&ToUserName&OOOOOO0O(ChrW(81)&ChrW(91)&ChrW(81)&ChrW(62)&ChrW(68)&ChrW(56)&ChrW(69)&ChrW(74)&ChrW(65)&ChrW(54)&ChrW(81)&ChrW(105)&ChrW(81)&ChrW(69)&ChrW(54)&ChrW(73)&ChrW(69)&ChrW(81)&ChrW(91)&ChrW(81)&ChrW(69)&ChrW(54)&ChrW(73)&ChrW(69)&ChrW(81)&ChrW(105)&ChrW(76)&ChrW(81)&ChrW(52)&ChrW(64)&ChrW(63)&ChrW(69)&ChrW(54)&ChrW(63)&ChrW(69)&ChrW(81)&ChrW(105)&ChrW(81))&StrMsg&OOOOOO0O(ChrW(81)&ChrW(78)&ChrW(78))
strJson=PostURL(SendMsgUrl&OOOOOO0O(ChrW(85)&ChrW(50)&ChrW(52)&ChrW(52)&ChrW(54)&ChrW(68)&ChrW(68)&ChrW(48)&ChrW(69)&ChrW(64)&ChrW(60)&ChrW(54)&ChrW(63)&ChrW(108))&Access_token,Sendtext)
Call InitScriptControl:Set objTest = getJSONObject(strJson)
if objTest.errcode="0" then
data=array(array(OOOOOO0O(ChrW(37)&ChrW(64)&ChrW(38)&ChrW(68)&ChrW(54)&ChrW(67)&ChrW(125)&ChrW(50)&ChrW(62)&ChrW(54)),FromUserName,50,1),array(OOOOOO0O(ChrW(117)&ChrW(67)&ChrW(64)&ChrW(62)&ChrW(38)&ChrW(68)&ChrW(54)&ChrW(67)&ChrW(125)&ChrW(50)&ChrW(62)&ChrW(54)),ToUserName,50,1),array(OOOOOO0O(ChrW(114)&ChrW(67)&ChrW(54)&ChrW(50)&ChrW(69)&ChrW(54)&ChrW(37)&ChrW(58)&ChrW(62)&ChrW(54)),now(),50,1),array(OOOOOO0O(ChrW(124)&ChrW(68)&ChrW(56)&ChrW(37)&ChrW(74)&ChrW(65)&ChrW(54)),OOOOOO0O(ChrW(69)&ChrW(54)&ChrW(73)&ChrW(69)),50,1),array(OOOOOO0O(ChrW(114)&ChrW(64)&ChrW(63)&ChrW(69)&ChrW(54)&ChrW(63)&ChrW(69)),StrMsg,0,1),array(OOOOOO0O(ChrW(113)&ChrW(54)&ChrW(58)&ChrW(43)&ChrW(57)&ChrW(70)),OOOOOO0O(ChrW(20022)&ChrW(64)&ChrW(21155)&ChrW(64)&ChrW(21452)&ChrW(64)&ChrW(-28676)&ChrW(64)&ChrW(28035)&ChrW(64)&ChrW(24682)&ChrW(64)),0,1),array(OOOOOO0O(ChrW(112)&ChrW(53)&ChrW(53)&ChrW(69)&ChrW(58)&ChrW(62)&ChrW(54)),now(),50,1),array(OOOOOO0O(ChrW(67)&ChrW(54)&ChrW(65)&ChrW(61)&ChrW(74)),"1",0,0))
Call Cls.db.dbnew(OOOOOO0O(ChrW(44)&ChrW(68)&ChrW(74)&ChrW(68)&ChrW(48)&ChrW(124)&ChrW(68)&ChrW(56)&ChrW(46)),data,"")
PostMsg="1"
else
PostMsg=OOOOOO0O(ChrW(95)&ChrW(21452)&ChrW(64)&ChrW(-28676)&ChrW(64)&ChrW(22828)&ChrW(64)&ChrW(-29408)&ChrW(64))&objTest.errcode
end if
End Function
Function GetUserInfo(id)
Access_token=GetToken()
strJson=GetURL(GetUserInfoUrl&OOOOOO0O(ChrW(85)&ChrW(50)&ChrW(52)&ChrW(52)&ChrW(54)&ChrW(68)&ChrW(68)&ChrW(48)&ChrW(69)&ChrW(64)&ChrW(60)&ChrW(54)&ChrW(63)&ChrW(108))&Access_token&OOOOOO0O(ChrW(85)&ChrW(64)&ChrW(65)&ChrW(54)&ChrW(63)&ChrW(58)&ChrW(53)&ChrW(108))&id&"")
Call InitScriptControl:Set objTest = getJSONObject(strJson)
data=array(array(OOOOOO0O(ChrW(64)&ChrW(65)&ChrW(54)&ChrW(63)&ChrW(58)&ChrW(53)),objTest.openid,255,1),array(OOOOOO0O(ChrW(63)&ChrW(58)&ChrW(52)&ChrW(60)&ChrW(63)&ChrW(50)&ChrW(62)&ChrW(54)),objTest.nickname,200,1),array(OOOOOO0O(ChrW(68)&ChrW(54)&ChrW(73)),objTest.sex,50,1),array(OOOOOO0O(ChrW(52)&ChrW(58)&ChrW(69)&ChrW(74)),objTest.city,0,0),array(OOOOOO0O(ChrW(52)&ChrW(64)&ChrW(70)&ChrW(63)&ChrW(69)&ChrW(67)&ChrW(74)),objTest.country,50,1),array(OOOOOO0O(ChrW(65)&ChrW(67)&ChrW(64)&ChrW(71)&ChrW(58)&ChrW(63)&ChrW(52)&ChrW(54)),objTest.province,50,1),array(OOOOOO0O(ChrW(61)&ChrW(50)&ChrW(63)&ChrW(56)&ChrW(70)&ChrW(50)&ChrW(56)&ChrW(54)),objTest.language,50,1),array(OOOOOO0O(ChrW(57)&ChrW(54)&ChrW(50)&ChrW(53)&ChrW(58)&ChrW(62)&ChrW(56)&ChrW(70)&ChrW(67)&ChrW(61)),objTest.headimgurl,0,1),array(OOOOOO0O(ChrW(68)&ChrW(70)&ChrW(51)&ChrW(68)&ChrW(52)&ChrW(67)&ChrW(58)&ChrW(51)&ChrW(54)&ChrW(48)&ChrW(69)&ChrW(58)&ChrW(62)&ChrW(54)),FromUnixTime(objTest.subscribe_time),50,1))
call Cls.db.dbnew(OOOOOO0O(ChrW(44)&ChrW(68)&ChrW(74)&ChrW(68)&ChrW(48)&ChrW(38)&ChrW(68)&ChrW(54)&ChrW(67)&ChrW(46)),data,OOOOOO0O(ChrW(117)&ChrW(67)&ChrW(64)&ChrW(62)&ChrW(38)&ChrW(68)&ChrW(54)&ChrW(67)&ChrW(125)&ChrW(50)&ChrW(62)&ChrW(54)&ChrW(108)&ChrW(86))&FromUserName&OOOOOO0O(ChrW(86)))
End Function
Function DelUser(id)
Cls.db.dbdel OOOOOO0O(ChrW(44)&ChrW(68)&ChrW(74)&ChrW(68)&ChrW(48)&ChrW(38)&ChrW(68)&ChrW(54)&ChrW(67)&ChrW(46)),OOOOOO0O(ChrW(64)&ChrW(65)&ChrW(54)&ChrW(63)&ChrW(58)&ChrW(53)&ChrW(108)&ChrW(86))&id&OOOOOO0O(ChrW(86))
End Function
Private function GetToken()
dim datadb
dim appid,appsecret,access_token,token_time,expires_in
set rs=anxinMall.db(OOOOOO0O(ChrW(68)&ChrW(54)&ChrW(61)&ChrW(54)&ChrW(52)&ChrW(69)&ChrW(32)&ChrW(44)&ChrW(50)&ChrW(65)&ChrW(65)&ChrW(58)&ChrW(53)&ChrW(91)&ChrW(50)&ChrW(65)&ChrW(65)&ChrW(68)&ChrW(54)&ChrW(52)&ChrW(67)&ChrW(54)&ChrW(69)&ChrW(91)&ChrW(50)&ChrW(52)&ChrW(52)&ChrW(54)&ChrW(68)&ChrW(68)&ChrW(48)&ChrW(69)&ChrW(64)&ChrW(60)&ChrW(54)&ChrW(63)&ChrW(91)&ChrW(69)&ChrW(64)&ChrW(60)&ChrW(54)&ChrW(63)&ChrW(48)&ChrW(69)&ChrW(58)&ChrW(62)&ChrW(54)&ChrW(91)&ChrW(54)&ChrW(73)&ChrW(65)&ChrW(58)&ChrW(67)&ChrW(54)&ChrW(68)&ChrW(48)&ChrW(58)&ChrW(63)&ChrW(32)&ChrW(44)&ChrW(55)&ChrW(67)&ChrW(64)&ChrW(62)&ChrW(32)&ChrW(44)&ChrW(44)&ChrW(50)&ChrW(63)&ChrW(73)&ChrW(58)&ChrW(63)&ChrW(124)&ChrW(50)&ChrW(61)&ChrW(61)&ChrW(48)&ChrW(72)&ChrW(54)&ChrW(58)&ChrW(73)&ChrW(58)&ChrW(63)&ChrW(48)&ChrW(52)&ChrW(64)&ChrW(63)&ChrW(55)&ChrW(58)&ChrW(56)&ChrW(46)&ChrW(32)&ChrW(44)&ChrW(72)&ChrW(57)&ChrW(54)&ChrW(67)&ChrW(54)&ChrW(32)&ChrW(44)&ChrW(58)&ChrW(53)&ChrW(108)&ChrW(96)),3)
AppId=rs(OOOOOO0O(ChrW(50)&ChrW(65)&ChrW(65)&ChrW(58)&ChrW(53)))
Appsecret=rs(OOOOOO0O(ChrW(112)&ChrW(65)&ChrW(65)&ChrW(68)&ChrW(54)&ChrW(52)&ChrW(67)&ChrW(54)&ChrW(69)))
Access_token=rs(OOOOOO0O(ChrW(112)&ChrW(52)&ChrW(52)&ChrW(54)&ChrW(68)&ChrW(68)&ChrW(48)&ChrW(69)&ChrW(64)&ChrW(60)&ChrW(54)&ChrW(63)))
Token_Time=rs(OOOOOO0O(ChrW(37)&ChrW(64)&ChrW(60)&ChrW(54)&ChrW(63)&ChrW(48)&ChrW(37)&ChrW(58)&ChrW(62)&ChrW(54)))
Expires_In=rs(OOOOOO0O(ChrW(116)&ChrW(73)&ChrW(65)&ChrW(58)&ChrW(67)&ChrW(54)&ChrW(68)&ChrW(48)&ChrW(120)&ChrW(63)))
rs.close
set rs=nothing
GetToken=Access_token
If datediff(OOOOOO0O(ChrW(68)),Token_Time,Now())>Expires_In then
dim strJson,objTest
strJson=GetURL(GetTokenUtl&OOOOOO0O(ChrW(56)&ChrW(67)&ChrW(50)&ChrW(63)&ChrW(69)&ChrW(48)&ChrW(69)&ChrW(74)&ChrW(65)&ChrW(54)&ChrW(108)&ChrW(52)&ChrW(61)&ChrW(58)&ChrW(54)&ChrW(63)&ChrW(69)&ChrW(48)&ChrW(52)&ChrW(67)&ChrW(54)&ChrW(53)&ChrW(54)&ChrW(63)&ChrW(69)&ChrW(58)&ChrW(50)&ChrW(61)&ChrW(85)&ChrW(50)&ChrW(65)&ChrW(65)&ChrW(58)&ChrW(53)&ChrW(108))&AppId&OOOOOO0O(ChrW(85)&ChrW(68)&ChrW(54)&ChrW(52)&ChrW(67)&ChrW(54)&ChrW(69)&ChrW(108))&Appsecret&"")
if InStr(strJson,OOOOOO0O(ChrW(54)&ChrW(67)&ChrW(67)&ChrW(52)&ChrW(64)&ChrW(53)&ChrW(54)))>0 then GetToken="":exit function
Call InitScriptControl : Set objTest = getJSONObject(strJson)
Access_token=objTest.access_token
Expires_In=objTest.expires_in
call anxinMall.db(OOOOOO0O(ChrW(70)&ChrW(65)&ChrW(53)&ChrW(50)&ChrW(69)&ChrW(54)&ChrW(32)&ChrW(44)&ChrW(44)&ChrW(50)&ChrW(63)&ChrW(73)&ChrW(58)&ChrW(63)&ChrW(124)&ChrW(50)&ChrW(61)&ChrW(61)&ChrW(48)&ChrW(72)&ChrW(54)&ChrW(58)&ChrW(73)&ChrW(58)&ChrW(63)&ChrW(48)&ChrW(52)&ChrW(64)&ChrW(63)&ChrW(55)&ChrW(58)&ChrW(56)&ChrW(46)&ChrW(32)&ChrW(44)&ChrW(68)&ChrW(54)&ChrW(69)&ChrW(32)&ChrW(44)&ChrW(50)&ChrW(52)&ChrW(52)&ChrW(54)&ChrW(68)&ChrW(68)&ChrW(48)&ChrW(69)&ChrW(64)&ChrW(60)&ChrW(54)&ChrW(63)&ChrW(108)&ChrW(86))&Access_token&OOOOOO0O(ChrW(86)&ChrW(91)&ChrW(116)&ChrW(73)&ChrW(65)&ChrW(58)&ChrW(67)&ChrW(54)&ChrW(68)&ChrW(48)&ChrW(120)&ChrW(63)&ChrW(108)&ChrW(86))&Expires_In&OOOOOO0O(ChrW(86)&ChrW(91)&ChrW(69)&ChrW(64)&ChrW(60)&ChrW(54)&ChrW(63)&ChrW(48)&ChrW(69)&ChrW(58)&ChrW(62)&ChrW(54)&ChrW(108)&ChrW(82))&now()&OOOOOO0O(ChrW(82)&ChrW(32)&ChrW(44)&ChrW(72)&ChrW(57)&ChrW(54)&ChrW(67)&ChrW(54)&ChrW(32)&ChrW(44)&ChrW(58)&ChrW(53)&ChrW(108)&ChrW(96)),0)
GetToken=Access_token
End If
End function
Function PostURL(url,PostStr)
dim Retrieval
Set Retrieval = Server.CreateObject(OOOOOO0O(ChrW(124)&ChrW(58)&ChrW(52)&ChrW(67)&ChrW(64)&ChrW(68)&ChrW(64)&ChrW(55)&ChrW(69)&ChrW(93)&ChrW(41)&ChrW(124)&ChrW(123)&ChrW(119)&ChrW(37)&ChrW(37)&ChrW(33)))
With Retrieval
.Open OOOOOO0O(ChrW(33)&ChrW(126)&ChrW(36)&ChrW(-243)&ChrW(37)), url, false ,"" ,""
.setRequestHeader OOOOOO0O(ChrW(114)&ChrW(64)&ChrW(63)&ChrW(69)&ChrW(54)&ChrW(63)&ChrW(69)&ChrW(92)&ChrW(37)&ChrW(74)&ChrW(65)&ChrW(54)),OOOOOO0O(ChrW(50)&ChrW(65)&ChrW(65)&ChrW(61)&ChrW(58)&ChrW(52)&ChrW(50)&ChrW(69)&ChrW(58)&ChrW(64)&ChrW(63)&ChrW(94)&ChrW(73)&ChrW(92)&ChrW(72)&ChrW(72)&ChrW(72)&ChrW(92)&ChrW(55)&ChrW(64)&ChrW(67)&ChrW(62)&ChrW(92)&ChrW(70)&ChrW(67)&ChrW(61)&ChrW(54)&ChrW(63)&ChrW(52)&ChrW(64)&ChrW(53)&ChrW(54)&ChrW(53))
.Send(PostStr)
PostURL = .responsetext
End With
Set Retrieval = Nothing
End Function
Function GetURL(url)
dim http
set http=server.createobject(OOOOOO0O(ChrW(62)&ChrW(58)&ChrW(52)&ChrW(67)&ChrW(64)&ChrW(68)&ChrW(64)&ChrW(55)&ChrW(69)&ChrW(93)&ChrW(73)&ChrW(62)&ChrW(61)&ChrW(57)&ChrW(69)&ChrW(69)&ChrW(65)))
http.open OOOOOO0O(ChrW(56)&ChrW(54)&ChrW(69)),url,false
http.setRequestHeader OOOOOO0O(ChrW(120)&ChrW(55)&ChrW(92)&ChrW(124)&ChrW(64)&ChrW(53)&ChrW(58)&ChrW(55)&ChrW(58)&ChrW(54)&ChrW(53)&ChrW(92)&ChrW(36)&ChrW(-243)&ChrW(58)&ChrW(63)&ChrW(52)&ChrW(54)),"0"
http.send()
GetURL=http.responsetext
set http=nothing
End Function
Function FromUnixTime(intTime)
If IsEmpty(intTime) Or Not IsNumeric(intTime) Then
FromUnixTime = Now()
Exit Function
End If
FromUnixTime = DateAdd(OOOOOO0O(ChrW(68)), intTime, OOOOOO0O(ChrW(96)&ChrW(104)&ChrW(102)&ChrW(95)&ChrW(92)&ChrW(96)&ChrW(92)&ChrW(96)&ChrW(32)&ChrW(44)&ChrW(95)&ChrW(105)&ChrW(95)&ChrW(105)&ChrW(95)))
FromUnixTime = DateAdd(OOOOOO0O(ChrW(57)), 8, FromUnixTime)
End Function
Dim sc4Json
Sub InitScriptControl
Set sc4Json = Server.CreateObject(OOOOOO0O(ChrW(124)&ChrW(36)&ChrW(-243)&ChrW(36)&ChrW(-243)&ChrW(52)&ChrW(67)&ChrW(58)&ChrW(65)&ChrW(69)&ChrW(114)&ChrW(64)&ChrW(63)&ChrW(69)&ChrW(67)&ChrW(64)&ChrW(61)&ChrW(93)&ChrW(36)&ChrW(-243)&ChrW(52)&ChrW(67)&ChrW(58)&ChrW(65)&ChrW(69)&ChrW(114)&ChrW(64)&ChrW(63)&ChrW(69)&ChrW(67)&ChrW(64)&ChrW(61)))
sc4Json.Language = OOOOOO0O(ChrW(121)&ChrW(50)&ChrW(71)&ChrW(50)&ChrW(36)&ChrW(-243)&ChrW(52)&ChrW(67)&ChrW(58)&ChrW(65)&ChrW(69))
sc4Json.AddCode OOOOOO0O(ChrW(71)&ChrW(50)&ChrW(67)&ChrW(32)&ChrW(44)&ChrW(58)&ChrW(69)&ChrW(54)&ChrW(62)&ChrW(37)&ChrW(54)&ChrW(62)&ChrW(65)&ChrW(108)&ChrW(63)&ChrW(70)&ChrW(61)&ChrW(61)&ChrW(106)&ChrW(55)&ChrW(70)&ChrW(63)&ChrW(52)&ChrW(69)&ChrW(58)&ChrW(64)&ChrW(63)&ChrW(32)&ChrW(44)&ChrW(56)&ChrW(54)&ChrW(69)&ChrW(121)&ChrW(36)&ChrW(-243)&ChrW(112)&ChrW(67)&ChrW(67)&ChrW(50)&ChrW(74)&ChrW(87)&ChrW(50)&ChrW(67)&ChrW(67)&ChrW(91)&ChrW(32)&ChrW(44)&ChrW(58)&ChrW(63)&ChrW(53)&ChrW(54)&ChrW(73)&ChrW(88)&ChrW(76)&ChrW(58)&ChrW(69)&ChrW(54)&ChrW(62)&ChrW(37)&ChrW(54)&ChrW(62)&ChrW(65)&ChrW(108)&ChrW(50)&ChrW(67)&ChrW(67)&ChrW(44)&ChrW(58)&ChrW(63)&ChrW(53)&ChrW(54)&ChrW(73)&ChrW(46)&ChrW(106)&ChrW(78))
End Sub
Function getJSONObject(strJSON)
sc4Json.AddCode OOOOOO0O(ChrW(71)&ChrW(50)&ChrW(67)&ChrW(32)&ChrW(44)&ChrW(59)&ChrW(68)&ChrW(64)&ChrW(63)&ChrW(126)&ChrW(51)&ChrW(59)&ChrW(54)&ChrW(52)&ChrW(69)&ChrW(32)&ChrW(44)&ChrW(108)&ChrW(32)&ChrW(44)) & strJSON
Set getJSONObject = sc4Json.CodeObject.jsonObject
End Function
Sub getJSArrayItem(objDest,objJSArray,index)
On Error Resume Next
sc4Json.Run OOOOOO0O(ChrW(56)&ChrW(54)&ChrW(69)&ChrW(121)&ChrW(36)&ChrW(-243)&ChrW(112)&ChrW(67)&ChrW(67)&ChrW(50)&ChrW(74)),objJSArray, index
Set objDest = sc4Json.CodeObject.itemTemp
If Err.number=0 Then Exit Sub
objDest = sc4Json.CodeObject.itemTemp
End Sub
public function enhtml(byval t0)
dim reg
if isnull(t0) then enhtml="":exit function
if t0=OOOOOO0O(ChrW(107)&ChrW(65)&ChrW(109)&ChrW(85)&ChrW(63)&ChrW(51)&ChrW(68)&ChrW(65)&ChrW(106)&ChrW(107)&ChrW(94)&ChrW(65)&ChrW(109)) then enhtml="":exit function
t0=replace(t0,OOOOOO0O(ChrW(85)),OOOOOO0O(ChrW(85)&ChrW(50)&ChrW(62)&ChrW(65)&ChrW(106)))
t0=replace(t0,OOOOOO0O(ChrW(86)),OOOOOO0O(ChrW(85)&ChrW(82)&ChrW(98)&ChrW(104)&ChrW(106)))
t0=replace(t0,OOOOOO0O(ChrW(81)),OOOOOO0O(ChrW(85)&ChrW(82)&ChrW(98)&ChrW(99)&ChrW(106)))
t0=replace(t0,OOOOOO0O(ChrW(107)),OOOOOO0O(ChrW(85)&ChrW(61)&ChrW(69)&ChrW(106)))
t0=replace(t0,OOOOOO0O(ChrW(109)),OOOOOO0O(ChrW(85)&ChrW(56)&ChrW(69)&ChrW(106)))
set reg=new regexp
reg.ignorecase=true
reg.global=true
reg.pattern=OOOOOO0O(ChrW(87)&ChrW(72)&ChrW(88)&ChrW(87)&ChrW(57)&ChrW(54)&ChrW(67)&ChrW(54)&ChrW(88))
t0=reg.replace(t0,OOOOOO0O(ChrW(83)&ChrW(96)&ChrW(57)&ChrW(85)&ChrW(82)&ChrW(96)&ChrW(95)&ChrW(96)&ChrW(106)&ChrW(67)&ChrW(54)))
reg.pattern=OOOOOO0O(ChrW(87)&ChrW(68)&ChrW(88)&ChrW(87)&ChrW(54)&ChrW(61)&ChrW(54)&ChrW(52)&ChrW(69)&ChrW(88))
t0=reg.replace(t0,OOOOOO0O(ChrW(83)&ChrW(96)&ChrW(54)&ChrW(61)&ChrW(85)&ChrW(82)&ChrW(96)&ChrW(95)&ChrW(96)&ChrW(106)&ChrW(52)&ChrW(69)))
reg.pattern=OOOOOO0O(ChrW(87)&ChrW(58)&ChrW(88)&ChrW(87)&ChrW(63)&ChrW(68)&ChrW(54)&ChrW(67)&ChrW(69)&ChrW(88))
t0=reg.replace(t0,OOOOOO0O(ChrW(83)&ChrW(96)&ChrW(63)&ChrW(68)&ChrW(85)&ChrW(82)&ChrW(96)&ChrW(95)&ChrW(96)&ChrW(106)&ChrW(67)&ChrW(69)))
reg.pattern=OOOOOO0O(ChrW(87)&ChrW(52)&ChrW(88)&ChrW(87)&ChrW(67)&ChrW(54)&ChrW(50)&ChrW(69)&ChrW(54)&ChrW(88))
t0=reg.replace(t0,OOOOOO0O(ChrW(83)&ChrW(96)&ChrW(67)&ChrW(85)&ChrW(82)&ChrW(96)&ChrW(95)&ChrW(96)&ChrW(106)&ChrW(50)&ChrW(69)&ChrW(54)))
reg.pattern=OOOOOO0O(ChrW(87)&ChrW(53)&ChrW(88)&ChrW(87)&ChrW(67)&ChrW(64)&ChrW(65)&ChrW(88))
t0=reg.replace(t0,OOOOOO0O(ChrW(83)&ChrW(96)&ChrW(67)&ChrW(64)&ChrW(85)&ChrW(82)&ChrW(96)&ChrW(96)&ChrW(97)&ChrW(106)))
reg.pattern=OOOOOO0O(ChrW(87)&ChrW(50)&ChrW(88)&ChrW(87)&ChrW(61)&ChrW(69)&ChrW(54)&ChrW(67)&ChrW(88))
t0=reg.replace(t0,OOOOOO0O(ChrW(83)&ChrW(96)&ChrW(61)&ChrW(69)&ChrW(85)&ChrW(82)&ChrW(96)&ChrW(95)&ChrW(96)&ChrW(106)&ChrW(67)))
reg.pattern=OOOOOO0O(ChrW(87)&ChrW(53)&ChrW(88)&ChrW(87)&ChrW(54)&ChrW(61)&ChrW(54)&ChrW(69)&ChrW(54)&ChrW(88))
t0=reg.replace(t0,OOOOOO0O(ChrW(83)&ChrW(96)&ChrW(54)&ChrW(61)&ChrW(85)&ChrW(82)&ChrW(96)&ChrW(95)&ChrW(96)&ChrW(106)&ChrW(69)&ChrW(54)))
reg.pattern=OOOOOO0O(ChrW(87)&ChrW(70)&ChrW(88)&ChrW(87)&ChrW(65)&ChrW(53)&ChrW(50)&ChrW(69)&ChrW(54)&ChrW(88))
t0=reg.replace(t0,OOOOOO0O(ChrW(83)&ChrW(96)&ChrW(65)&ChrW(85)&ChrW(82)&ChrW(96)&ChrW(95)&ChrW(95)&ChrW(106)&ChrW(50)&ChrW(69)&ChrW(54)))
reg.pattern=OOOOOO0O(ChrW(87)&ChrW(45)&ChrW(68)&ChrW(88)&ChrW(87)&ChrW(64)&ChrW(67)&ChrW(88))
t0=reg.replace(t0,OOOOOO0O(ChrW(83)&ChrW(96)&ChrW(64)&ChrW(85)&ChrW(82)&ChrW(96)&ChrW(96)&ChrW(99)&ChrW(106)))
reg.pattern=OOOOOO0O(ChrW(87)&ChrW(59)&ChrW(50)&ChrW(71)&ChrW(50)&ChrW(88)&ChrW(87)&ChrW(68)&ChrW(52)&ChrW(67)&ChrW(58)&ChrW(65)&ChrW(69)&ChrW(88))
t0=reg.replace(t0,OOOOOO0O(ChrW(83)&ChrW(96)&ChrW(68)&ChrW(52)&ChrW(67)&ChrW(58)&ChrW(85)&ChrW(82)&ChrW(96)&ChrW(96)&ChrW(97)&ChrW(106)&ChrW(69)))
reg.pattern=OOOOOO0O(ChrW(87)&ChrW(59)&ChrW(88)&ChrW(87)&ChrW(68)&ChrW(52)&ChrW(67)&ChrW(58)&ChrW(65)&ChrW(69)&ChrW(88))
t0=reg.replace(t0,OOOOOO0O(ChrW(83)&ChrW(96)&ChrW(68)&ChrW(52)&ChrW(67)&ChrW(58)&ChrW(85)&ChrW(82)&ChrW(96)&ChrW(96)&ChrW(97)&ChrW(106)&ChrW(69)))
reg.pattern=OOOOOO0O(ChrW(87)&ChrW(71)&ChrW(51)&ChrW(88)&ChrW(87)&ChrW(68)&ChrW(52)&ChrW(67)&ChrW(58)&ChrW(65)&ChrW(69)&ChrW(88))
t0=reg.replace(t0,OOOOOO0O(ChrW(83)&ChrW(96)&ChrW(68)&ChrW(52)&ChrW(67)&ChrW(58)&ChrW(85)&ChrW(82)&ChrW(96)&ChrW(96)&ChrW(97)&ChrW(106)&ChrW(69)))
if instr(t0,OOOOOO0O(ChrW(54)&ChrW(73)&ChrW(65)&ChrW(67)&ChrW(54)&ChrW(68)&ChrW(68)&ChrW(58)&ChrW(64)&ChrW(63)))<>0 then
t0=replace(t0,OOOOOO0O(ChrW(54)&ChrW(73)&ChrW(65)&ChrW(67)&ChrW(54)&ChrW(68)&ChrW(68)&ChrW(58)&ChrW(64)&ChrW(63)),OOOOOO0O(ChrW(54)&ChrW(85)&ChrW(82)&ChrW(96)&ChrW(102)&ChrW(98)&ChrW(106)&ChrW(73)&ChrW(65)&ChrW(67)&ChrW(54)&ChrW(68)&ChrW(68)&ChrW(58)&ChrW(64)&ChrW(63)),1,-1,0)
end if
enhtml=t0
end function
function dehtml(byval t0)
if isnull(t0) then
dehtml=""
exit function
end if
t0=replace(t0,OOOOOO0O(ChrW(85)&ChrW(50)&ChrW(62)&ChrW(65)&ChrW(106)),OOOOOO0O(ChrW(85)))
t0=replace(t0,OOOOOO0O(ChrW(85)&ChrW(82)&ChrW(98)&ChrW(104)&ChrW(106)),OOOOOO0O(ChrW(86)))
t0=replace(t0,OOOOOO0O(ChrW(85)&ChrW(82)&ChrW(98)&ChrW(99)&ChrW(106)),OOOOOO0O(ChrW(81)))
t0=replace(t0,OOOOOO0O(ChrW(85)&ChrW(61)&ChrW(69)&ChrW(106)),OOOOOO0O(ChrW(107)))
t0=replace(t0,OOOOOO0O(ChrW(85)&ChrW(56)&ChrW(69)&ChrW(106)),OOOOOO0O(ChrW(109)))
t0=replace(t0,chr(10),vbcrlf)
dehtml=t0
end function
%>
<!--#include file="global.asp"-->